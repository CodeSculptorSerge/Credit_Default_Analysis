# Прогнозирование дефолтов по кредитным картам

## Датасет

Датасет взят с UCI Machine Learning Repository: [UCI Credit Card Default Dataset](https://archive.ics.uci.edu/ml/datasets/default+of+credit+card+clients)

### Используемый файл:
- `default_of_credit_card_clients.xls`: Основные данные о клиентах и статусах их кредитов.

### Описание столбцов:

- `ID`: Идентификатор клиента
- `LIMIT_BAL`: Размер кредитного лимита
- `SEX`: Пол клиента (1 = мужской, 2 = женский)
- `EDUCATION`: Уровень образования (1 = магистр, 2 = бакалавр, 3 = среднее и т.д.)
- `MARRIAGE`: Семейное положение (1 = женат/замужем, 2 = холост, 3 = другие)
- `AGE`: Возраст клиента
- `PAY_0 - PAY_6`: Статус погашения по месяцам (-1 = платеж вовремя, 1 = платеж задержан на один месяц и т.д.)
- `BILL_AMT1 - BILL_AMT6`: Суммы счетов по месяцам
- `PAY_AMT1 - PAY_AMT6`: Суммы платежей по месяцам
- `default payment next month`: Целевая переменная (1 = дефолт, 0 = нет дефолта)

## Цели и задачи

### Основные цели:
- Анализировать данные о клиентах, чтобы выявить ключевые факторы, влияющие на вероятность дефолта.
- Использовать модели машинного обучения для прогнозирования дефолтов.
- Предоставить конкретные бизнес-инсайты для улучшения управления рисками.

### Основные задачи:
1. **Загрузка и предварительная проверка данных**
   - Загрузка данных из файла Excel.
   - Предварительный анализ и проверка данных.

2. **Очистка и предобработка данных**
   - Проверка и заполнение пропущенных значений.
   - Оптимизация типов данных для уменьшения объема памяти.

3. **Обучение и сравнение моделей XGBoost и LightGBM**
   - Разделение данных на тренировочную и тестовую выборки.
   - Обучение моделей XGBoost и LightGBM.
   - Прогнозирование и оценка моделей по метрике AUC-ROC.

4. **Анализ и выявление ключевых факторов (инсайтов)**
   - Определение важности признаков для моделей.
   - Вывод ключевых факторов, влияющих на вероятность дефолта.

5. **Визуализация результатов**
   - Визуализация важности признаков.
   - Создание графиков и диаграмм для представления результатов.

## Используемые библиотеки

Для выполнения проекта использовались следующие библиотеки Python:

- pandas
- numpy
- scikit-learn
- xgboost
- lightgbm
- matplotlib
- seaborn
- xlrd (для загрузки данных из Excel)

## Инсайты и выводы

### Основные инсайты:
1. **Ключевые факторы дефолтов**:
   - Основные факторы, влияющие на вероятность дефолта: лимит кредита, статус погашения и возраст клиента. Для снижения дефолтов важно внимательно оценивать эти параметры при выдаче кредита.

2. **Сегментация клиентов**:
   - Различные категории клиентов (по семейному положению и уровню образования) имеют разные риски дефолта. Эффективное управление рисками требует персонализированного подхода к разным группам клиентов.

3. **Закономерности в дефолтах**:
   - Экономические условия и изменения в кредитной политике могут существенно влиять на количество дефолтов. Регулярный анализ этих факторов поможет своевременно корректировать кредитную политику.

4. **Прогнозирование будущих дефолтов**:
   - Использование моделей машинного обучения для прогнозирования будущих дефолтов позволяет более точно планировать риски и разрабатывать превентивные меры.

5. **Выявление аномалий и подозрительных транзакций**:
   - Выявление аномальных или подозрительных транзакций помогает в предотвращении мошенничества и улучшении общей безопасности системы.

### Интерпретация результатов:
- Анализ данных показал, что основные факторы дефолта включают лимит кредита, статус погашения и возраст клиента. Эти факторы необходимо учитывать при выдаче кредитов.
- Сегментация клиентов по семейному положению и уровню образования позволяет лучше понять риски дефолта для различных групп клиентов и разрабатывать более эффективные стратегии управления рисками.
- Закономерности в дефолтах подчеркивают важность мониторинга экономических условий и корректировки кредитной политики в зависимости от изменений на рынке.
- Прогнозирование будущих дефолтов с помощью моделей машинного обучения позволяет заранее выявлять риски и принимать превентивные меры.
- Выявление аномалий и подозрительных транзакций способствует предотвращению мошенничества и повышению общей безопасности.